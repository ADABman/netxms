#
# Makefile for building NetXMS Core Agent for Novell NetWare platform
# Copyright (c) 2004 Victor Kirhenshtein
#

include ../../../netware/Makefile.inc

OBJECTS  = messages.o actions.o comm.o config.o exec.o getparam.o lpp.o \
	   nxagentd.o session.o snmpproxy.o subagent.o sysinfo.o tools.o \
	   trap.o upgrade.o
EXEC     = nxagentd.nlm
DEF      = nxagentd.def
OBJTMP   = nxagentd_r.o

all: $(EXEC)

$(OBJECTS): nxagentd.h Makefile.nw

.cpp.o:
	$(CC) $(CFLAGS) -o $*.o $<

.c.o:
	$(CC) $(CFLAGS) -o $*.o $<

$(EXEC): $(OBJECTS) $(DEF)
	$(PRELINK) -o $(OBJTMP) $(OBJECTS) $(PLDFLAGS)
	$(LINK) $(LDFLAGS) -T $(DEF)
	rm -f $(OBJTMP)
	cp nxagentd.nlm ../../../netware/bin

messages.c: messages.mc
	$(PERL) ../../../tools/mc.pl $<

clean:
	rm -f *.o $(EXEC) messages.c messages.h
