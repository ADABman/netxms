/*
** System-defined events
**
** ex: syntax=sql
*/

#define THRESHOLD_EVENT_PARAMS \
	'   1) Parameter name#0D#0A   2) Item description#0D#0A   3) Threshold value#0D#0A   4) Actual value#0D#0A   5) Data collection item ID#0D#0A   6) Instance'


/*
** System events
*/

INSERT INTO events (event_id,name,severity,flags,message,description) VALUES
	(
		EVENT_NODE_ADDED, 'SYS_NODE_ADDED',
		EVENT_SEVERITY_NORMAL, 1,
		'Node added',
		'Generated when new node object added to the database.#0D#0A' CONCAT
		'Parameters:#0D#0A' CONCAT
		'   No message-specific parameters'
	);
INSERT INTO events (event_id,name,severity,flags,message,description) VALUES
	(
		EVENT_SUBNET_ADDED, 'SYS_SUBNET_ADDED',
		EVENT_SEVERITY_NORMAL, 0,
		'Subnet added',
		'Generated when new subnet object added to the database.#0D#0A' CONCAT
		'Parameters:#0D#0A' CONCAT
		'   No message-specific parameters'
	);
INSERT INTO events (event_id,name,severity,flags,message,description) VALUES
	(
		EVENT_INTERFACE_ADDED, 'SYS_IF_ADDED',
		EVENT_SEVERITY_NORMAL, 1,
		'Interface "%2" added (IP Addr: %3/%4, IfIndex: %5)',
		'Generated when new interface object added to the database.#0D#0A' CONCAT
		'Please note that source of event is node, not an interface itself.#0D#0A' CONCAT
		'Parameters:#0D#0A' CONCAT
		'   1) Interface object ID#0D#0A' CONCAT
		'   2) Interface name#0D#0A' CONCAT
		'   3) Interface IP address#0D#0A' CONCAT
		'   4) Interface netmask#0D#0A' CONCAT
		'   5) Interface index'
	);
INSERT INTO events (event_id,name,severity,flags,message,description) VALUES
	(
		EVENT_INTERFACE_UP, 'SYS_IF_UP',
		EVENT_SEVERITY_NORMAL, 1,
		'Interface "%2" changed state to UP (IP Addr: %3/%4, IfIndex: %5)',
		'Generated when interface goes up.#0D#0A' CONCAT
		'Please note that source of event is node, not an interface itself.#0D#0A' CONCAT
		'Parameters:#0D#0A' CONCAT
		'   1) Interface object ID#0D#0A' CONCAT
		'   2) Interface name#0D#0A' CONCAT
		'   3) Interface IP address#0D#0A' CONCAT
		'   4) Interface netmask#0D#0A' CONCAT
		'   5) Interface index'
	);
INSERT INTO events (event_id,name,severity,flags,message,description) VALUES
	(
		EVENT_INTERFACE_DOWN, 'SYS_IF_DOWN',
		EVENT_SEVERITY_WARNING, 1,
		'Interface "%2" changed state to DOWN (IP Addr: %3/%4, IfIndex: %5)',
		'Generated when interface goes down.#0D#0A' CONCAT
		'Please note that source of event is node, not an interface itself.#0D#0A' CONCAT
		'Parameters:#0D#0A' CONCAT
		'   1) Interface object ID#0D#0A' CONCAT
		'   2) Interface name#0D#0A' CONCAT
		'   3) Interface IP address#0D#0A' CONCAT
		'   4) Interface netmask#0D#0A' CONCAT
		'   5) Interface index'
	);
INSERT INTO events (event_id,name,severity,flags,message,description) VALUES
	(
		EVENT_NODE_NORMAL, 'SYS_NODE_NORMAL',
		EVENT_SEVERITY_NORMAL, 1,
		'Node status changed to NORMAL',
		'Generated when node status changed to normal.#0D#0A' CONCAT
		'Parameters:#0D#0A' CONCAT
		'   1) Previous node status'
	);
INSERT INTO events (event_id,name,severity,flags,message,description) VALUES
	(
		EVENT_NODE_WARNING, 'SYS_NODE_WARNING', 
		EVENT_SEVERITY_WARNING, 1,
		'Node status changed to WARNING',
		'Generated when node status changed to "Warning".#0D#0A' CONCAT
		'Parameters:#0D#0A' CONCAT
		'   1) Previous node status'
	);
INSERT INTO events (event_id,name,severity,flags,message,description) VALUES
	(
		EVENT_NODE_MINOR, 'SYS_NODE_MINOR',
		EVENT_SEVERITY_MINOR, 1,
		'Node status changed to MINOR',
		'Generated when node status changed to "Minor Problem" (informational).#0D#0A' CONCAT
		'Parameters:#0D#0A' CONCAT
		'   1) Previous node status'
	);
INSERT INTO events (event_id,name,severity,flags,message,description) VALUES
	(
		EVENT_NODE_MAJOR, 'SYS_NODE_MAJOR', 
		EVENT_SEVERITY_MAJOR, 1,
		'Node status changed to MAJOR',
		'Generated when node status changed to "Major Problem".#0D#0A' CONCAT
		'Parameters:#0D#0A' CONCAT
		'   1) Previous node status'
	);
INSERT INTO events (event_id,name,severity,flags,message,description) VALUES
	(
		EVENT_NODE_CRITICAL, 'SYS_NODE_CRITICAL', 
		EVENT_SEVERITY_CRITICAL, 1,
		'Node status changed to CRITICAL',
		'Generated when node status changed to critical.#0D#0A' CONCAT
		'Parameters:#0D#0A' CONCAT
		'   1) Previous node status'
	);
INSERT INTO events (event_id,name,severity,flags,message,description) VALUES
	(
		EVENT_NODE_UNKNOWN, 'SYS_NODE_UNKNOWN',
		EVENT_SEVERITY_NORMAL, 1,
		'Node status changed to UNKNOWN',
		'Generated when node status changed to unknown.#0D#0A' CONCAT
		'Parameters:#0D#0A' CONCAT
		'   1) Previous node status'
	);
INSERT INTO events (event_id,name,severity,flags,message,description) VALUES
	(
		EVENT_NODE_UNMANAGED, 'SYS_NODE_UNMANAGED',
		EVENT_SEVERITY_NORMAL, 1,
		'Node status changed to UNMANAGED',
		'Generated when node status changed to unmanaged.#0D#0A' CONCAT
		'Parameters:#0D#0A' CONCAT
		'   1) Previous node status'
	);
INSERT INTO events (event_id,name,severity,flags,message,description) VALUES
	(
		EVENT_NODE_FLAGS_CHANGED, 'SYS_NODE_CAP_CHANGED',
		EVENT_SEVERITY_NORMAL, 0,
		'Node capabilities changed (Old: %1; New: %2)',
		'Generated when node capabilities changed.#0D#0A' CONCAT
		'Parameters:#0D#0A' CONCAT
		'   1) Old capabilities#0D#0A' CONCAT
		'   2) New capabilities'
	);
INSERT INTO events (event_id,name,severity,flags,message,description) VALUES
	(
		EVENT_SNMP_FAIL, 'SYS_SNMP_UNREACHEABLE', 
		EVENT_SEVERITY_NORMAL, 0,
		'SNMP agent is not responding',
		'Generated when node#27s SNMP agent is not responding.#0D#0A' CONCAT
		'Parameters:#0D#0A' CONCAT
		'   No message-specific parameters'
	);
INSERT INTO events (event_id,name,severity,flags,message,description) VALUES
	(
		EVENT_AGENT_FAIL, 'SYS_AGENT_UNREACHEABLE',
		EVENT_SEVERITY_NORMAL, 0,
		'Native agent is not responding',
		'Generated when node#27s native agent is not responding.#0D#0A' CONCAT
		'Parameters:#0D#0A' CONCAT
		'   No message-specific parameters'
	);
INSERT INTO events (event_id,name,severity,flags,message,description) VALUES
	(
		EVENT_INTERFACE_DELETED, 'SYS_IF_DELETED',
		EVENT_SEVERITY_NORMAL, 1,
		'Interface "%2" deleted (IP Addr: %3/%4, IfIndex: %1)',
		'Generated when interface object deleted from the database.#0D#0A' CONCAT
		'Please note that source of event is node, not an interface itself.#0D#0A' CONCAT
		'Parameters:#0D#0A' CONCAT
		'   1) Interface index#0D#0A' CONCAT
		'   2) Interface name#0D#0A' CONCAT
		'   3) Interface IP address#0D#0A' CONCAT
		'   4) Interface netmask'
	);
INSERT INTO events (event_id,name,severity,flags,message,description) VALUES
	(
		EVENT_THRESHOLD_REACHED, 'SYS_THRESHOLD_REACHED',
		EVENT_SEVERITY_WARNING, 1,
		'Threshold reached for data collection item #22%2#22 (Parameter: %1; Threshold value: %3; Actual value: %4)',
		'Generated when threshold value reached for specific data collection item.#0D#0A' CONCAT
		'Parameters:#0D#0A' CONCAT
		THRESHOLD_EVENT_PARAMS
	);
INSERT INTO events (event_id,name,severity,flags,message,description) VALUES
	(
		EVENT_THRESHOLD_REARMED, 'SYS_THRESHOLD_REARMED',
		EVENT_SEVERITY_NORMAL, 1,
		'Threshold rearmed for data collection item %2 (Parameter: %1)',
		'Generated when threshold check is rearmed for specific data collection item.#0D#0A' CONCAT
		'Parameters:#0D#0A' CONCAT
		'   1) Parameter name#0D#0A' CONCAT
		'   2) Item description#0D#0A' CONCAT
		'   3) Data collection item ID'
	);
INSERT INTO events (event_id,name,severity,flags,message,description) VALUES
	(
		EVENT_SUBNET_DELETED, 'SYS_SUBNET_DELETED',
		EVENT_SEVERITY_NORMAL, 0,
		'Subnet deleted',
		'Generated when subnet object deleted from the database.#0D#0A' CONCAT
		'Parameters:#0D#0A' CONCAT
		'   No message-specific parameters'
	);
INSERT INTO events (event_id,name,severity,flags,message,description) VALUES
	(
		EVENT_THREAD_HANGS, 'SYS_THREAD_HANG', 
		EVENT_SEVERITY_CRITICAL, 1,
		'Thread "%1" is not responding',
		'Generated when one of the system threads hangs or stops unexpectedly.#0D#0A' CONCAT
		'Parameters:#0D#0A' CONCAT
		'   1) Thread name'
	);
INSERT INTO events (event_id,name,severity,flags,message,description) VALUES
	(
		EVENT_THREAD_RUNNING, 'SYS_THREAD_RUNNING',
		EVENT_SEVERITY_NORMAL, 1,
		'Thread "%1" was returned to running state',
		'Generated when one of the system threads which previously hangs or stops unexpectedly was returned to running state.#0D#0A' CONCAT
		'Parameters:#0D#0A' CONCAT
		'   1) Thread name'
	);
INSERT INTO events (event_id,name,severity,flags,message,description) VALUES
	(
		EVENT_SMTP_FAILURE, 'SYS_SMTP_FAILURE', 
		EVENT_SEVERITY_WARNING, 1,
		'Unable to send e-mail to <%3>: %2',
		'Generated when server is unable to send e-mail.#0D#0A' CONCAT
		'Parameters:#0D#0A' CONCAT
		'   1) Error code#0D#0A' CONCAT
		'   2) Error text#0D#0A' CONCAT
		'   3) Recipient address#0D#0A' CONCAT
		'   4) Mail subject'
	);
INSERT INTO events (event_id,name,severity,flags,message,description) VALUES
	(
		EVENT_MAC_ADDR_CHANGED, 'SYS_MAC_ADDR_CHANGED', 
		EVENT_SEVERITY_WARNING, 1,
		'MAC address for interface %3 changed from %4 to %5',
		'Generated when server detects change of interface#27s MAC address.#0D#0A' CONCAT
		'Parameters:#0D#0A' CONCAT
		'   1) Interface object ID#0D#0A' CONCAT
		'   2) Interface index#0D#0A' CONCAT
		'   3) Interface name#0D#0A' CONCAT
		'   4) Old MAC address#0D#0A' CONCAT
		'   5) New MAC address'
	);
INSERT INTO events (event_id,name,severity,flags,message,description) VALUES
	(
		EVENT_INCORRECT_NETMASK, 'SYS_INCORRECT_NETMASK', 
		EVENT_SEVERITY_MINOR, 1,
		'Invalid network mask %4 on interface "%3", should be %5',
		'Generated when server detects invalid network mask on an interface.#0D#0A' CONCAT
		'Parameters:#0D#0A' CONCAT
		'   1) Interface object ID#0D#0A' CONCAT
		'   2) Interface index#0D#0A' CONCAT
		'   3) Interface name#0D#0A' CONCAT
		'   4) Actual network mask on interface#0D#0A' CONCAT
		'   5) Correct network mask'
	);


/*
** SNMP traps
*/

INSERT INTO events (event_id,name,severity,flags,message,description) VALUES
	(
		EVENT_SNMP_UNMATCHED_TRAP, 'SNMP_UNMATCHED_TRAP',
		EVENT_SEVERITY_NORMAL, 1,
		'SNMP trap received: %1 (Parameters: %2)',
		'Generated when system receives an SNMP trap without match in trap configuration table#0D#0A' CONCAT
		'Parameters:#0D#0A' CONCAT
		'   1) SNMP trap OID#0D#0A' CONCAT
		'   2) Trap parameters'
	);
INSERT INTO events (event_id,name,severity,flags,message,description) VALUES
	(
		EVENT_SNMP_COLD_START, 'SNMP_COLD_START',
		EVENT_SEVERITY_NORMAL, 1,
		'System was cold-started',
		'Generated when system receives a coldStart SNMP trap#0D#0A' CONCAT
		'Parameters:#0D#0A' CONCAT
		'   No message-specific parameters'
	);
INSERT INTO events (event_id,name,severity,flags,message,description) VALUES
	(
		EVENT_SNMP_WARM_START, 'SNMP_WARM_START',
		EVENT_SEVERITY_NORMAL, 1,
		'System was warm-started',
		'Generated when system receives a warmStart SNMP trap#0D#0A' CONCAT
		'Parameters:#0D#0A' CONCAT
		'   No message-specific parameters'
	);
INSERT INTO events (event_id,name,severity,flags,message,description) VALUES
	(
		EVENT_SNMP_LINK_DOWN, 'SNMP_LINK_DOWN',
		EVENT_SEVERITY_MAJOR, 1,
		'Link is down',
		'Generated when system receives a linkDown SNMP trap#0D#0A' CONCAT
		'Parameters:#0D#0A' CONCAT
		'   No message-specific parameters'
	);
INSERT INTO events (event_id,name,severity,flags,message,description) VALUES
	(
		EVENT_SNMP_LINK_UP, 'SNMP_LINK_UP',
		EVENT_SEVERITY_NORMAL, 1,
		'Link is up',
		'Generated when system receives a linkUp SNMP trap#0D#0A' CONCAT
		'Parameters:#0D#0A' CONCAT
		'   No message-specific parameters'
	);
INSERT INTO events (event_id,name,severity,flags,message,description) VALUES
	(
		EVENT_SNMP_AUTH_FAILURE, 'SNMP_AUTH_FAILURE',
		EVENT_SEVERITY_WARNING, 1,
		'SNMP authentication failure',
		'Generated when system receives an authenticationFailure SNMP trap#0D#0A' CONCAT
		'Parameters:#0D#0A' CONCAT
		'   No message-specific parameters'
	);
INSERT INTO events (event_id,name,severity,flags,message,description) VALUES
	(
		EVENT_SNMP_EGP_NL, 'SNMP_EGP_NEIGHBOR_LOSS',
		EVENT_SEVERITY_WARNING, 1,
		'EGP neighbor loss',
		'Generated when system receives an egpNeighborLoss SNMP trap#0D#0A' CONCAT
		'Parameters:#0D#0A' CONCAT
		'   No message-specific parameters'
	);


/*
** Following is a set of predefined events for thresholds
** These events can occupy ID space 4000 ... 4999
*/

INSERT INTO events (event_id,name,severity,flags,message,description) VALUES
	(
		4000, 'DC_HIGH_CPU_UTIL',
		EVENT_SEVERITY_MINOR, 1,
		'CPU utilization exceeds allowed maximum of %3 (Current: %4)',
		'Custom data collection threshold event.#0D#0A' CONCAT
		'Parameters:#0D#0A' CONCAT
		THRESHOLD_EVENT_PARAMS
	);
INSERT INTO events (event_id,name,severity,flags,message,description) VALUES
	(
		4001, 'DC_HIGH_PROCLOAD',
		EVENT_SEVERITY_MINOR, 1,
		'Processor load average exceeds allowed maximum of %3 (Current: %4)',
		'Custom data collection threshold event.#0D#0A' CONCAT
		'Parameters:#0D#0A' CONCAT
		THRESHOLD_EVENT_PARAMS
	);
INSERT INTO events (event_id,name,severity,flags,message,description) VALUES
	(
		4002, 'DC_HOST_RESTARTED',
		EVENT_SEVERITY_NORMAL, 1,
		'Host was restarted within last 5 minutes',
		'Custom data collection threshold event.#0D#0A' CONCAT
		'Parameters:#0D#0A' CONCAT
		THRESHOLD_EVENT_PARAMS
	);
INSERT INTO events (event_id,name,severity,flags,message,description) VALUES
	(
		4003, 'DC_AGENT_RESTARTED',
		EVENT_SEVERITY_NORMAL, 1,
		'NetXMS agent was restarted within last 5 minutes',
		'Custom data collection threshold event.#0D#0A' CONCAT
		'Parameters:#0D#0A' CONCAT
		THRESHOLD_EVENT_PARAMS
	);
INSERT INTO events (event_id,name,severity,flags,message,description) VALUES
	(
		4004, 'DC_SERVICE_NOT_RUNNING',
		EVENT_SEVERITY_MAJOR, 1,
		'Service #22%6#22 is not running',
		'Custom data collection threshold event.#0D#0A' CONCAT
		'Parameters:#0D#0A' CONCAT
		THRESHOLD_EVENT_PARAMS
	);
INSERT INTO events (event_id,name,severity,flags,message,description) VALUES
	(
		4005, 'DC_MAILBOX_TOO_LARGE',
		EVENT_SEVERITY_WARNING, 1,
		'Mailbox #22%6#22 exceeds size limit (allowed size: %3; actual size: %4)',
		'Custom data collection threshold event.#0D#0A' CONCAT
		'Parameters:#0D#0A' CONCAT
		THRESHOLD_EVENT_PARAMS
	);
INSERT INTO events (event_id,name,severity,flags,message,description) VALUES
	(
		4006, 'DC_AGENT_VERSION_CHANGE',
		EVENT_SEVERITY_NORMAL, 1,
		'NetXMS agent version was changed from %3 to %4',
		'Custom data collection threshold event.#0D#0A' CONCAT
		'Parameters:#0D#0A' CONCAT
		THRESHOLD_EVENT_PARAMS
	);
INSERT INTO events (event_id,name,severity,flags,message,description) VALUES
	(
		4007, 'DC_HOSTNAME_CHANGE',
		EVENT_SEVERITY_WARNING, 1,
		'Host name was changed from %3 to %4',
		'Custom data collection threshold event.#0D#0A' CONCAT
		'Parameters:#0D#0A' CONCAT
		THRESHOLD_EVENT_PARAMS
	);
INSERT INTO events (event_id,name,severity,flags,message,description) VALUES
	(
		4008, 'DC_FILE_CHANGE',
		EVENT_SEVERITY_WARNING, 1,
		'File #22%6#22 was changed',
		'Custom data collection threshold event.#0D#0A' CONCAT
		'Parameters:#0D#0A' CONCAT
		THRESHOLD_EVENT_PARAMS
	);
