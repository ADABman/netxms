/*
** Input file for database initialization script.
** This file should be processed by C preprocessor to produce
** real initialization script.
**
** ex: syntax=c
*/

// Common constants
#include <nxevent.h>
#include <nms_locks.h>
#include <nximage.h>
#include <netxmsdb.h>
#include <nxnt.h>
#include <nxtools.h>

#include "database.in"

// Start transaction

#if defined(DB_POSTGRESQL) || defined(DB_SQLITE)
BEGIN TRANSACTION;
#endif

// Actual SQL queries
#include "schema.in"

#ifdef SCHEMA_ONLY
INSERT INTO config (var_name,var_value,is_visible,need_server_restart)
	VALUES ('DBFormatVersion',DB_FORMAT_VERSION,0,1);
INSERT INTO config (var_name,var_value,is_visible,need_server_restart)
	VALUES ('DBSyntax',DB_SYNTAX,0,1);
#else
#include "setup.in"
#include "events.in"
#include "images.in"
#include "policy.in"
#include "traps.in"
#include "objtools.in"
#include "scripts.in"
#include "maps.in"
#endif

// End transaction
#if defined(DB_POSTGRESQL) || defined(DB_SQLITE)
COMMIT TRANSACTION;
#endif
